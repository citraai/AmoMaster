# AmoMaster 要件定義書

## 1. プロジェクト概要

| 項目 | 内容 |
|---|---|
| **アプリ名** | AmoMaster（アモマスター） |
| **コンセプト** | 毒舌AIがユーザーをパートナーの専門家に育てる恋愛サポートアプリ |
| **ターゲット** | パートナーをもっと幸せにしたい人（性別・性的指向問わず） |
| **本番URL** | https://amo-master.vercel.app |

---

## 2. 機能要件

### 2.1 認証機能
- [x] メール/パスワード認証
- [x] パスワードハッシュ化（セキュリティ対応）
- [x] セッション管理（JWT）
- [ ] ソーシャルログイン（Google/LINE）- 未実装

### 2.2 オンボーディング
- [x] ユーザーの性別選択（男性/女性/その他/選択しない）
- [x] パートナー呼称選択（彼/彼女/パートナー）
- [x] 初回ログイン時のみ表示、以降はスキップ

### 2.3 ホーム画面（ダッシュボード）
- [x] AI毒舌マスターからの日替わりメッセージ
- [x] 直近の記録表示
- [x] 今後のイベント表示
- [x] クイック記録ボタン（好み/名言/イベント）
- [x] 月間記録数・連続ログイン日数の統計

### 2.4 記録機能
- [x] パートナーの「好き」を記録
- [x] パートナーの「NG」を記録
- [x] 名言・エピソード記録
- [x] イベント（記念日・予定）記録
- [x] カテゴリ別フィルタリング
- [x] 検索機能

### 2.5 デイリーミッション
- [x] 日替わりミッション表示
- [x] ミッション達成でXP獲得
- [x] レベルアップシステム
- [x] 記録系ミッションの自動チェック
- [x] 毎日0時リセット（ローカルタイム）

### 2.6 AIマスター（チャット）
- [x] 毒舌キャラクターによるアドバイス
- [x] パートナーの記録を参照した回答
- [x] Google Gemini API連携

### 2.7 地雷チェッカー
- [x] パートナーの地雷ワード記録
- [x] 地雷回避アドバイス

### 2.8 設定
- [x] パートナー名設定
- [x] ログアウト機能
- [x] アプリ情報表示

---

## 3. 非機能要件

### 3.1 パフォーマンス
- ページ読み込み: 3秒以内
- API応答: 2秒以内

### 3.2 セキュリティ
- パスワードハッシュ化
- JWT認証
- HTTPS通信
- ユーザーごとのデータ分離

### 3.3 可用性
- Vercel自動スケーリング
- Turso DB高可用性

---

## 4. 技術スタック

| カテゴリ | 技術 |
|---|---|
| **フレームワーク** | Next.js 15 (App Router) |
| **言語** | TypeScript |
| **スタイリング** | Tailwind CSS / Vanilla CSS |
| **認証** | NextAuth.js v5 |
| **データベース** | Turso (LibSQL) |
| **ORM** | Drizzle ORM |
| **AI** | Google Gemini API |
| **ホスティング** | Vercel |

---

## 5. データベース設計

### 5.1 テーブル構成

```
users           - ユーザー情報・プロファイル
preferences     - パートナーの好み/NG記録
quotes          - 名言・エピソード記録
events          - イベント・記念日
settings        - ユーザー設定
user_progress   - ミッション進捗・XP
monthly_summaries - 月間サマリー
```

### 5.2 主要カラム

**users**
- id (PK)
- email
- password_hash
- gender
- partner_pronoun
- created_at

**preferences**
- id (PK)
- user_id (FK)
- category (like/ng/gift/place/food)
- content
- tags
- created_at

---

## 6. 画面一覧

| パス | 画面名 | 説明 |
|---|---|---|
| `/login` | ログイン | メール/パスワード入力 |
| `/onboarding` | オンボーディング | 初回設定 |
| `/` | ホーム | ダッシュボード |
| `/records` | 記録一覧 | 全記録の閲覧・検索 |
| `/missions` | ミッション | デイリーミッション |
| `/master` | AIマスター | チャット画面 |
| `/mine-checker` | 地雷チェッカー | NG管理 |
| `/settings` | 設定 | 各種設定 |

---

## 7. 今後の拡張予定

### Phase 2（予定）
- [ ] PWA対応（ホーム画面追加）
- [ ] プッシュ通知
- [ ] ソーシャルログイン

### Phase 3（予定）
- [ ] プレミアムプラン
- [ ] AIアドバイス回数制限
- [ ] 広告表示

---

## 8. 運用情報

| 項目 | 詳細 |
|---|---|
| **GitHubリポジトリ** | https://github.com/citraai/AmoMaster |
| **Vercelプロジェクト** | amo-master |
| **Turso DB名** | amomaster |

---

*最終更新: 2024年12月26日*
